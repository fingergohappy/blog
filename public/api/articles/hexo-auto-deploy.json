{"title":"hexo push后自动部署github pages","uid":"3a126c86808bf36e1aa89411751a60c9","slug":"hexo-auto-deploy","date":"2023-09-20T01:31:18.000Z","updated":"2023-09-21T14:57:24.942Z","comments":true,"path":"api/articles/hexo-auto-deploy.json","keywords":null,"cover":"https://source.unsplash.com/lzh3hPtJz9c/1200x628","content":"<h1 id=\"hexo-提交后自动部署github-page\"><a href=\"#hexo-提交后自动部署github-page\" class=\"headerlink\" title=\"hexo 提交后自动部署github page\"></a>hexo 提交后自动部署github page</h1><p>hexo有几种部署方式,一种是本地编译后,直接push <code>public</code>路径下的静态文件,一种是通过<code>cli</code>方式,向仓库提交<code>source</code>下的的<code>markdown</code>文件,触发<code>action</code>.实现自动部署</p>\n<p>本文主要说明后一种方式.</p>\n<h2 id=\"创建github-workflow\"><a href=\"#创建github-workflow\" class=\"headerlink\" title=\"创建github workflow\"></a>创建github workflow</h2><p>在<code>hexo</code>的根目录的<code>.github/workflows/pages.yml</code>路径下创建文件,文件内容:</p>\n<div class=\"language-yaml\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">yaml</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Pages</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BD93F9\">on</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">  </span><span style=\"color: #8BE9FD\">push</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #8BE9FD\">branches</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">main</span><span style=\"color: #F8F8F2\">  </span><span style=\"color: #6272A4\"># default branch</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #8BE9FD\">jobs</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">  </span><span style=\"color: #8BE9FD\">pages</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #8BE9FD\">runs-on</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">ubuntu-latest</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #8BE9FD\">permissions</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #8BE9FD\">contents</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">write</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #8BE9FD\">steps</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">uses</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">actions/checkout@v3</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">with</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">token</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #6272A4\"># If your repository depends on submodule, please see: https://github.com/actions/checkout</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">submodules</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">recursive</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Use Node.js 16.x</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">uses</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">actions/setup-node@v2</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">with</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #6272A4\"># 看下自己本地的noe版本</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">node-version</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #E9F284\">&#39;</span><span style=\"color: #F1FA8C\">16</span><span style=\"color: #E9F284\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Cache NPM dependencies</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">uses</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">actions/cache@v2</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">with</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">path</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">node_modules</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">key</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">$&#123;&#123; runner.OS &#125;&#125;-npm-cache</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">restore-keys</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #FF79C6\">|</span></span>\n<span class=\"line\"><span style=\"color: #F1FA8C\">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Install Dependencies</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">run</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">npm install</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Build</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">run</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">npm run build</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">      </span><span style=\"color: #FF79C6\">-</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #8BE9FD\">name</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">Deploy</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">uses</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">peaceiris/actions-gh-pages@v3</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #8BE9FD\">with</span><span style=\"color: #FF79C6\">:</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">github_token</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">$&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">          </span><span style=\"color: #8BE9FD\">publish_dir</span><span style=\"color: #FF79C6\">:</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">./public</span></span></code></pre></div><h2 id=\"创建github-pages\"><a href=\"#创建github-pages\" class=\"headerlink\" title=\"创建github pages\"></a>创建github pages</h2><p>参考 <a href=\"https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site\">https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site</a></p>\n<p>创建完成后,微调一下:</p>\n<p>在<code>settings-&gt;Pages-&gt;Build and deployment-&gt;Branch</code>选项中,把<code>branch</code>改成<code>gh-pages</code></p>\n<h2 id=\"初始化本地仓库\"><a href=\"#初始化本地仓库\" class=\"headerlink\" title=\"初始化本地仓库\"></a>初始化本地仓库</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">git</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">init</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">.</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">git</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">remote</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">add</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">origin</span><span style=\"color: #F8F8F2\"> $&#123;你上面创建的仓库地址&#125;</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">git</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">remote</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">add</span><span style=\"color: #F8F8F2\">  </span><span style=\"color: #F1FA8C\">.</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">git</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">commit</span><span style=\"color: #F8F8F2\">  </span><span style=\"color: #BD93F9\">-m</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #E9F284\">&quot;</span><span style=\"color: #F1FA8C\">init project</span><span style=\"color: #E9F284\">&quot;</span></span></code></pre></div><h2 id=\"gitgnore\"><a href=\"#gitgnore\" class=\"headerlink\" title=\"gitgnore\"></a>gitgnore</h2><p>由于使用了<code>github</code>的自动部署功能,所以无需上传静态文件,在<code>hexo</code>根目录添加<code>.gitignore</code>文件</p>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">public/</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">.deploy*/</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">node_modules</span></span></code></pre></div><h2 id=\"提交\"><a href=\"#提交\" class=\"headerlink\" title=\"提交\"></a>提交</h2><p>最后提交到<code>main</code>分支</p>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">git</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">push</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #BD93F9\">-u</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">origin</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">main</span></span></code></pre></div><p>提交完成后,在<code>github</code>的<code>action</code>选项中可以看到正在构建,构建完成,就可以在<code>https://$&#123;your-username&#125;.github.io</code>路径访问你的在线博客了</p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://hexo.io/docs/github-pages\">https://hexo.io/docs/github-pages</a></p>\n","feature":true,"text":"hexo 提交后自动部署github page...","permalink":"/post/hexo-auto-deploy","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"hexo","slug":"hexo","count":1,"path":"api/categories/hexo.json"}],"tags":[{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#hexo-%E6%8F%90%E4%BA%A4%E5%90%8E%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2github-page\"><span class=\"toc-text\">hexo 提交后自动部署github page</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BAgithub-workflow\"><span class=\"toc-text\">创建github workflow</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BAgithub-pages\"><span class=\"toc-text\">创建github pages</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93\"><span class=\"toc-text\">初始化本地仓库</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#gitgnore\"><span class=\"toc-text\">gitgnore</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8F%90%E4%BA%A4\"><span class=\"toc-text\">提交</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li></ol></li></ol>","author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"macos下,实现vim切换模式自动切换输入法","uid":"a80e863ad04e203843f50e139a5edeb2","slug":"macos-vim-auto-change-input-method","date":"2023-09-20T02:37:19.000Z","updated":"2023-09-21T14:56:36.885Z","comments":true,"path":"api/articles/macos-vim-auto-change-input-method.json","keywords":null,"cover":"https://source.unsplash.com/m_HRfLhgABo/1200x628","text":"macos结合使用,vim切换模式实现自动切换输入法...","permalink":"/post/macos-vim-auto-change-input-method","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"some litttle tricks","slug":"some-litttle-tricks","count":2,"path":"api/categories/some-litttle-tricks.json"}],"tags":[{"name":"vim","slug":"vim","count":3,"path":"api/tags/vim.json"},{"name":"macos","slug":"macos","count":1,"path":"api/tags/macos.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"gradle spring boot 打包无依赖jar","uid":"0610eea3c26eecbde57cb388bda23db3","slug":"gradle-spring-boot-without-dependency","date":"2023-12-22T12:21:39.000Z","updated":"2023-12-22T12:31:48.368Z","comments":true,"path":"api/articles/gradle-spring-boot-without-dependency.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","text":"gradle将spring boot项目打包成无依赖jar包的轻量级包...","permalink":"/post/gradle-spring-boot-without-dependency","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"java","slug":"java","count":2,"path":"api/categories/java.json"}],"tags":[{"name":"java","slug":"java","count":2,"path":"api/tags/java.json"},{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}