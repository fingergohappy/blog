{"title":"gradle将spring-boot和vue打入一个jar包","uid":"56b23b84b250019b3083e955ae6b9980","slug":"gradle-spring-boot-vue-one-jar","date":"2023-11-11T07:23:43.000Z","updated":"2023-11-11T07:48:48.040Z","comments":true,"path":"api/articles/gradle-spring-boot-vue-one-jar.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","content":"<p>之前用<code>maven</code>搞过将<code>spring-boot</code>和<code>vue</code>打成一个jar包,现在的项目,我使用了<code>gralde</code>,又是同样的需求,使用<code>gradle</code>的<code>composite</code>似乎更优雅一些.</p>\n<h1 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h1><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #8BE9FD\">.</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">build.gradle.kts</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">settings.gradle.kts</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">app</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #6272A4\">#spring-boot 目录</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">│  </span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">build.gradle.kts</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">│  </span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">settings.gradle.kts</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">web</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #6272A4\">#vue目录</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">│  </span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">build.gradle.kts</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">│  </span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">├──</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">settings.gradle.kts</span></span>\n<span class=\"line\"></span></code></pre></div><h1 id=\"结构说明\"><a href=\"#结构说明\" class=\"headerlink\" title=\"结构说明\"></a>结构说明</h1><p><code>app</code>和<code>web</code>分别为<code>spring-boot</code>和<code>vue</code>项目,就正常写就行,唯一不同的就是,<code>vue</code>项目里面添加一个<code>gradle</code>配置文件,</p>\n<h1 id=\"配置文件说明\"><a href=\"#配置文件说明\" class=\"headerlink\" title=\"配置文件说明\"></a>配置文件说明</h1><p>需要改动的地方就只有<code>web</code>和最外面的项目的<code>gradle</code>的配置文件需要改动</p>\n<h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><p>其中<code>web</code>的<code>build.gradle.kts</code>内容如下:</p>\n<div class=\"language-kotlin\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">kotlin</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">plugins</span><span style=\"color: #F8F8F2\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        base</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">tasks</span><span style=\"color: #F8F8F2\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">register</span><span style=\"color: #F8F8F2\">&lt;</span><span style=\"color: #8BE9FD; font-style: italic\">Exec</span><span style=\"color: #F8F8F2\">&gt;(</span><span style=\"color: #F1FA8C\">&quot;build-dev&quot;</span><span style=\"color: #F8F8F2\">)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">            </span><span style=\"color: #50FA7B\">workingDir</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;./&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">            </span><span style=\"color: #50FA7B\">commandLine</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;pnpm&quot;</span><span style=\"color: #F8F8F2\">,</span><span style=\"color: #F1FA8C\">&quot;run&quot;</span><span style=\"color: #F8F8F2\">,</span><span style=\"color: #F1FA8C\">&quot;build:dev&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        &#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">&#125;</span></span>\n<span class=\"line\"></span></code></pre></div><p>就是添加了一个打包任务</p>\n<h2 id=\"根目录\"><a href=\"#根目录\" class=\"headerlink\" title=\"根目录\"></a>根目录</h2><p>根目录的<code>gradle</code>配置文件需要调整的地方比较多</p>\n<p><code>setting.gradle.kts</code>:</p>\n<div class=\"language-kotlin\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">kotlin</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">rootProject.name </span><span style=\"color: #FF79C6\">=</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">&quot;example&quot;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6272A4\">// 这里很重要,使用includeBuild完成组合构建</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">includeBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;./app&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">includeBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;./web&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"></span></code></pre></div><p><code>build.gradle.kts</code>:</p>\n<div class=\"language-kotlin\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">kotlin</span><pre class=\"shiki dracula\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #50FA7B\">plugins</span><span style=\"color: #F8F8F2\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        base</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #50FA7B\">tasks</span><span style=\"color: #F8F8F2\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #50FA7B\">register</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;build-all&quot;</span><span style=\"color: #F8F8F2\">)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">dependsOn</span><span style=\"color: #F8F8F2\">(gradle.</span><span style=\"color: #50FA7B\">includedBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;app&quot;</span><span style=\"color: #F8F8F2\">).</span><span style=\"color: #50FA7B\">task</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;:classes&quot;</span><span style=\"color: #F8F8F2\">))</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">dependsOn</span><span style=\"color: #F8F8F2\">(gradle.</span><span style=\"color: #50FA7B\">includedBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;web&quot;</span><span style=\"color: #F8F8F2\">).</span><span style=\"color: #50FA7B\">task</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;:build-dev&quot;</span><span style=\"color: #F8F8F2\">))</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #50FA7B\">register</span><span style=\"color: #F8F8F2\">&lt;</span><span style=\"color: #8BE9FD; font-style: italic\">Copy</span><span style=\"color: #F8F8F2\">&gt;(</span><span style=\"color: #F1FA8C\">&quot;copy-static&quot;</span><span style=\"color: #F8F8F2\">)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">dependsOn</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;build-all&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #6272A4\">// gradle没有提供通过includeBuild直接获取build目录的api,只能这样写死</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #FF79C6\">val</span><span style=\"color: #F8F8F2\"> webDistPath </span><span style=\"color: #FF79C6\">=</span><span style=\"color: #F8F8F2\"> gradle.</span><span style=\"color: #50FA7B\">includedBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;web&quot;</span><span style=\"color: #F8F8F2\">).projectDir.</span><span style=\"color: #50FA7B\">getPath</span><span style=\"color: #F8F8F2\">() </span><span style=\"color: #FF79C6\">+</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">&quot;/dist-dev&quot;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #FF79C6\">val</span><span style=\"color: #F8F8F2\"> appClassesPath </span><span style=\"color: #FF79C6\">=</span><span style=\"color: #F8F8F2\"> gradle.</span><span style=\"color: #50FA7B\">includedBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;app&quot;</span><span style=\"color: #F8F8F2\">).projectDir.</span><span style=\"color: #50FA7B\">getPath</span><span style=\"color: #F8F8F2\">() </span><span style=\"color: #FF79C6\">+</span><span style=\"color: #F8F8F2\"> </span><span style=\"color: #F1FA8C\">&quot;/build/resources/main/static&quot;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">from</span><span style=\"color: #F8F8F2\">(webDistPath)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">                </span><span style=\"color: #50FA7B\">include</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;*&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        &#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">into</span><span style=\"color: #F8F8F2\">(appClassesPath)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    </span><span style=\"color: #50FA7B\">register</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;build-jar&quot;</span><span style=\"color: #F8F8F2\">)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">dependsOn</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;copy-static&quot;</span><span style=\"color: #F8F8F2\">)</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">        </span><span style=\"color: #50FA7B\">dependsOn</span><span style=\"color: #F8F8F2\">(gradle.</span><span style=\"color: #50FA7B\">includedBuild</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;app&quot;</span><span style=\"color: #F8F8F2\">).</span><span style=\"color: #50FA7B\">task</span><span style=\"color: #F8F8F2\">(</span><span style=\"color: #F1FA8C\">&quot;:jar&quot;</span><span style=\"color: #F8F8F2\">))</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #F8F8F2\">&#125;</span></span></code></pre></div><p>这样执行<code>gradle :build-jar</code>,就会生成一个带有<code>vue</code>打包后的<code>dist</code>目录的<code>jar</code>包</p>\n","text":"使用gradle将spring-boot和vue打入一个jar包...","permalink":"/post/gradle-spring-boot-vue-one-jar","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"gradle","slug":"gradle","count":1,"path":"api/categories/gradle.json"}],"tags":[{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"},{"name":"spring-boot","slug":"spring-boot","count":1,"path":"api/tags/spring-boot.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">项目结构</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BB%93%E6%9E%84%E8%AF%B4%E6%98%8E\"><span class=\"toc-text\">结构说明</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E\"><span class=\"toc-text\">配置文件说明</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#web\"><span class=\"toc-text\">web</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A0%B9%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">根目录</span></a></li></ol></li></ol>","author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"gradle spring boot 打包无依赖jar","uid":"0610eea3c26eecbde57cb388bda23db3","slug":"gradle-spring-boot-without-dependency","date":"2023-12-22T12:21:39.000Z","updated":"2023-12-22T12:31:48.368Z","comments":true,"path":"api/articles/gradle-spring-boot-without-dependency.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","text":"gradle将spring boot项目打包成无依赖jar包的轻量级包...","permalink":"/post/gradle-spring-boot-without-dependency","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"java","slug":"java","count":2,"path":"api/categories/java.json"}],"tags":[{"name":"java","slug":"java","count":2,"path":"api/tags/java.json"},{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"neovim配置formatters","uid":"278663bc5f0ce8aa9f1bcfa6468a4791","slug":"neovim-config-formatter","date":"2023-11-01T08:05:14.000Z","updated":"2023-11-01T08:27:31.037Z","comments":true,"path":"api/articles/neovim-config-formatter.json","keywords":null,"cover":"https://source.unsplash.com/gray-laptop-computer-turned-on-EaB4Ml7C7fE/1200x628","text":"neovim配置formatters...","permalink":"/post/neovim-config-formatter","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"neovim奇技淫巧","slug":"neovim奇技淫巧","count":2,"path":"api/categories/neovim奇技淫巧.json"}],"tags":[{"name":"neovim","slug":"neovim","count":2,"path":"api/tags/neovim.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}