{"title":"gradle将spring-boot和vue打入一个jar包","uid":"56b23b84b250019b3083e955ae6b9980","slug":"gradle-spring-boot-vue-one-jar","date":"2023-11-11T15:23:43.000Z","updated":"2023-12-22T12:36:39.314Z","comments":true,"path":"api/articles/gradle-spring-boot-vue-one-jar.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","content":"<p>之前用<code>maven</code>搞过将<code>spring-boot</code>和<code>vue</code>打成一个jar包,现在的项目,我使用了<code>gralde</code>,又是同样的需求,使用<code>gradle</code>的<code>composite</code>似乎更优雅一些.</p>\n<h1 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── build.gradle.kts</span><br><span class=\"line\">├── settings.gradle.kts</span><br><span class=\"line\">├── app <span class=\"comment\">#spring-boot 目录</span></span><br><span class=\"line\">│   ├── build.gradle.kts</span><br><span class=\"line\">│   ├── settings.gradle.kts</span><br><span class=\"line\">├── web <span class=\"comment\">#vue目录</span></span><br><span class=\"line\">│   ├── build.gradle.kts</span><br><span class=\"line\">│   ├── settings.gradle.kts</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"结构说明\"><a href=\"#结构说明\" class=\"headerlink\" title=\"结构说明\"></a>结构说明</h1><p><code>app</code>和<code>web</code>分别为<code>spring-boot</code>和<code>vue</code>项目,就正常写就行,唯一不同的就是,<code>vue</code>项目里面添加一个<code>gradle</code>配置文件,</p>\n<h1 id=\"配置文件说明\"><a href=\"#配置文件说明\" class=\"headerlink\" title=\"配置文件说明\"></a>配置文件说明</h1><p>需要改动的地方就只有<code>web</code>和最外面的项目的<code>gradle</code>的配置文件需要改动</p>\n<h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><p>其中<code>web</code>的<code>build.gradle.kts</code>内容如下:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">plugins&#123;</span><br><span class=\"line\">        base</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks&#123;</span><br><span class=\"line\">        register&lt;Exec&gt;(<span class=\"string\">&quot;build-dev&quot;</span>)&#123;</span><br><span class=\"line\">            workingDir(<span class=\"string\">&quot;./&quot;</span>)</span><br><span class=\"line\">            commandLine(<span class=\"string\">&quot;pnpm&quot;</span>,<span class=\"string\">&quot;run&quot;</span>,<span class=\"string\">&quot;build:dev&quot;</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>就是添加了一个打包任务</p>\n<h2 id=\"根目录\"><a href=\"#根目录\" class=\"headerlink\" title=\"根目录\"></a>根目录</h2><p>根目录的<code>gradle</code>配置文件需要调整的地方比较多</p>\n<p><code>setting.gradle.kts</code>:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">rootProject.name = <span class=\"string\">&quot;example&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 这里很重要,使用includeBuild完成组合构建</span></span><br><span class=\"line\">includeBuild(<span class=\"string\">&quot;./app&quot;</span>)</span><br><span class=\"line\">includeBuild(<span class=\"string\">&quot;./web&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>build.gradle.kts</code>:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">plugins &#123;</span><br><span class=\"line\">        base</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">tasks&#123;</span><br><span class=\"line\">    register(<span class=\"string\">&quot;build-all&quot;</span>)&#123;</span><br><span class=\"line\">        dependsOn(gradle.includedBuild(<span class=\"string\">&quot;app&quot;</span>).task(<span class=\"string\">&quot;:classes&quot;</span>))</span><br><span class=\"line\">        dependsOn(gradle.includedBuild(<span class=\"string\">&quot;web&quot;</span>).task(<span class=\"string\">&quot;:build-dev&quot;</span>))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    register&lt;Copy&gt;(<span class=\"string\">&quot;copy-static&quot;</span>)&#123;</span><br><span class=\"line\">        dependsOn(<span class=\"string\">&quot;build-all&quot;</span>)</span><br><span class=\"line\">        <span class=\"comment\">// gradle没有提供通过includeBuild直接获取build目录的api,只能这样写死</span></span><br><span class=\"line\">        <span class=\"keyword\">val</span> webDistPath = gradle.includedBuild(<span class=\"string\">&quot;web&quot;</span>).projectDir.getPath() + <span class=\"string\">&quot;/dist-dev&quot;</span></span><br><span class=\"line\">        <span class=\"keyword\">val</span> appClassesPath = gradle.includedBuild(<span class=\"string\">&quot;app&quot;</span>).projectDir.getPath() + <span class=\"string\">&quot;/build/resources/main/static&quot;</span></span><br><span class=\"line\">        from(webDistPath)&#123;</span><br><span class=\"line\">                include(<span class=\"string\">&quot;*&quot;</span>)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        into(appClassesPath)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    register(<span class=\"string\">&quot;build-jar&quot;</span>)&#123;</span><br><span class=\"line\">        dependsOn(<span class=\"string\">&quot;copy-static&quot;</span>)</span><br><span class=\"line\">        dependsOn(gradle.includedBuild(<span class=\"string\">&quot;app&quot;</span>).task(<span class=\"string\">&quot;:jar&quot;</span>))</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这样执行<code>gradle :build-jar</code>,就会生成一个带有<code>vue</code>打包后的<code>dist</code>目录的<code>jar</code>包</p>\n","text":"使用gradle将spring-boot和vue打入一个jar包...","permalink":"/post/gradle-spring-boot-vue-one-jar","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"gradle","slug":"gradle","count":1,"path":"api/categories/gradle.json"}],"tags":[{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"},{"name":"spring-boot","slug":"spring-boot","count":1,"path":"api/tags/spring-boot.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">项目结构</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BB%93%E6%9E%84%E8%AF%B4%E6%98%8E\"><span class=\"toc-text\">结构说明</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%B4%E6%98%8E\"><span class=\"toc-text\">配置文件说明</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#web\"><span class=\"toc-text\">web</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A0%B9%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">根目录</span></a></li></ol></li></ol>","author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"gradle spring boot 打包无依赖jar","uid":"0610eea3c26eecbde57cb388bda23db3","slug":"gradle-spring-boot-without-dependency","date":"2023-12-22T20:21:39.000Z","updated":"2023-12-22T12:36:39.314Z","comments":true,"path":"api/articles/gradle-spring-boot-without-dependency.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","text":"gradle将spring boot项目打包成无依赖jar包的轻量级包...","permalink":"/post/gradle-spring-boot-without-dependency","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"java","slug":"java","count":2,"path":"api/categories/java.json"}],"tags":[{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"},{"name":"java","slug":"java","count":2,"path":"api/tags/java.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"neovim配置formatters","uid":"278663bc5f0ce8aa9f1bcfa6468a4791","slug":"neovim-config-formatter","date":"2023-11-01T16:05:14.000Z","updated":"2023-12-22T12:36:39.322Z","comments":true,"path":"api/articles/neovim-config-formatter.json","keywords":null,"cover":"https://source.unsplash.com/gray-laptop-computer-turned-on-EaB4Ml7C7fE/1200x628","text":"neovim配置formatters...","permalink":"/post/neovim-config-formatter","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"neovim奇技淫巧","slug":"neovim奇技淫巧","count":2,"path":"api/categories/neovim奇技淫巧.json"}],"tags":[{"name":"neovim","slug":"neovim","count":2,"path":"api/tags/neovim.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}