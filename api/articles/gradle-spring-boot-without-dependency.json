{"title":"gradle spring boot 打包无依赖jar","uid":"0610eea3c26eecbde57cb388bda23db3","slug":"gradle-spring-boot-without-dependency","date":"2023-12-22T20:21:39.000Z","updated":"2024-01-05T08:09:03.738Z","comments":true,"path":"api/articles/gradle-spring-boot-without-dependency.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","content":"<h1 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h1><p>希望<code>spring-boot</code>的<code>jar</code>包不包含项目的依赖,打包成一个轻量<code>jar</code>包,方便部署和快速打包</p>\n<h1 id=\"方法一\"><a href=\"#方法一\" class=\"headerlink\" title=\"方法一:\"></a>方法一:</h1><p>修改<code>build.gradle.kts</code>:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">tasks.withType&lt;Jar&gt;&#123;</span><br><span class=\"line\">    manifest &#123;</span><br><span class=\"line\">        attributes[<span class=\"string\">&quot;Main-Class&quot;</span>] = <span class=\"string\">&quot;com.io.alyze.AlyzeApplicationKt&quot;</span></span><br><span class=\"line\">        <span class=\"comment\">//添加所有依赖的</span></span><br><span class=\"line\">        attributes[<span class=\"string\">&quot;Class-Path&quot;</span>] =  configurations.runtimeClasspath.<span class=\"keyword\">get</span>().files.joinToString(<span class=\"string\">&quot; &quot;</span>) &#123; <span class=\"string\">&quot;./libs/<span class=\"subst\">$&#123;it.name&#125;</span>&quot;</span> &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">tasks.register&lt;Copy&gt;(<span class=\"string\">&quot;jar-dependency&quot;</span>) &#123;</span><br><span class=\"line\">    dependsOn(<span class=\"string\">&quot;jar&quot;</span>)</span><br><span class=\"line\">    from(configurations.runtimeClasspath)</span><br><span class=\"line\">    into(layout.buildDirectory.dir(<span class=\"string\">&quot;libs/libs/&quot;</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>这样执行:<code>./gradlew :jar-dependency</code> 就会在<code>build/lib</code>目录生成一个<code>xxx-palin.jar</code>和一个<code>libs</code>文件夹</p>\n<p>将这两个文件拷贝在一起,以使用<code>java -jar xxx-plain.jar</code>直接运行</p>\n<h1 id=\"方法二\"><a href=\"#方法二\" class=\"headerlink\" title=\"方法二\"></a>方法二</h1><p>修改<code>build.gradle.kts</code>:</p>\n<figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tasks.register&lt;Copy&gt;(<span class=\"string\">&quot;jar-dependency&quot;</span>) &#123;</span><br><span class=\"line\">    dependsOn(<span class=\"string\">&quot;jar&quot;</span>)</span><br><span class=\"line\">    from(configurations.runtimeClasspath)</span><br><span class=\"line\">    into(layout.buildDirectory.dir(<span class=\"string\">&quot;libs/libs/&quot;</span>))</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<p>这样执行:<code>./gradlew :jar-dependency</code> 就会在<code>build/lib</code>目录生成一个<code>xxx-palin.jar</code>和一个<code>libs</code>文件夹</p>\n<p>将这两个文件拷贝在一起,可以使用<code>java -cp &quot;alyze-1.0-plain.jar:libs/*&quot; your_main_class_name</code>直接运行</p>\n","text":"gradle将spring boot项目打包成无依赖jar包的轻量级包...","permalink":"/post/gradle-spring-boot-without-dependency","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"java","slug":"java","count":2,"path":"api/categories/java.json"}],"tags":[{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"},{"name":"java","slug":"java","count":2,"path":"api/tags/java.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E8%83%8C%E6%99%AF\"><span class=\"toc-text\">背景</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">方法一:</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%96%B9%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">方法二</span></a></li></ol>","author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"linux下安装多版本jdk并进行切换","uid":"db3a8f8bcab31391aecd5f37a5eb1f26","slug":"linux-multi-jdk-config","date":"2024-01-05T15:24:32.000Z","updated":"2024-01-05T08:09:03.746Z","comments":true,"path":"api/articles/linux-multi-jdk-config.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","text":"如何优雅的linux下安装多版本的jdk并进行切换...","permalink":"/post/linux-multi-jdk-config","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"linux","slug":"linux","count":1,"path":"api/categories/linux.json"}],"tags":[{"name":"linux","slug":"linux","count":2,"path":"api/tags/linux.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"gradle将spring-boot和vue打入一个jar包","uid":"56b23b84b250019b3083e955ae6b9980","slug":"gradle-spring-boot-vue-one-jar","date":"2023-11-11T15:23:43.000Z","updated":"2024-01-05T08:09:03.738Z","comments":true,"path":"api/articles/gradle-spring-boot-vue-one-jar.json","keywords":null,"cover":"https://source.unsplash.com/1200x628","text":"使用gradle将spring-boot和vue打入一个jar包...","permalink":"/post/gradle-spring-boot-vue-one-jar","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"gradle","slug":"gradle","count":1,"path":"api/categories/gradle.json"}],"tags":[{"name":"gradle","slug":"gradle","count":2,"path":"api/tags/gradle.json"},{"name":"spring-boot","slug":"spring-boot","count":1,"path":"api/tags/spring-boot.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}