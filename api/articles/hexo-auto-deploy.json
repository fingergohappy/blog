{"title":"hexo push后自动部署github pages","uid":"3a126c86808bf36e1aa89411751a60c9","slug":"hexo-auto-deploy","date":"2023-09-20T09:31:18.000Z","updated":"2023-11-07T19:50:51.335Z","comments":true,"path":"api/articles/hexo-auto-deploy.json","keywords":null,"cover":"https://source.unsplash.com/lzh3hPtJz9c/1200x628","content":"<h1 id=\"hexo-提交后自动部署github-page\"><a href=\"#hexo-提交后自动部署github-page\" class=\"headerlink\" title=\"hexo 提交后自动部署github page\"></a>hexo 提交后自动部署github page</h1><p>hexo有几种部署方式,一种是本地编译后,直接push <code>public</code>路径下的静态文件,一种是通过<code>cli</code>方式,向仓库提交<code>source</code>下的的<code>markdown</code>文件,触发<code>action</code>.实现自动部署</p>\n<p>本文主要说明后一种方式.</p>\n<h2 id=\"创建github-workflow\"><a href=\"#创建github-workflow\" class=\"headerlink\" title=\"创建github workflow\"></a>创建github workflow</h2><p>在<code>hexo</code>的根目录的<code>.github/workflows/pages.yml</code>路径下创建文件,文件内容:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Pages</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\">  <span class=\"attr\">push:</span></span><br><span class=\"line\">    <span class=\"attr\">branches:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">main</span>  <span class=\"comment\"># default branch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\">  <span class=\"attr\">pages:</span></span><br><span class=\"line\">    <span class=\"attr\">runs-on:</span> <span class=\"string\">ubuntu-latest</span></span><br><span class=\"line\">    <span class=\"attr\">permissions:</span></span><br><span class=\"line\">      <span class=\"attr\">contents:</span> <span class=\"string\">write</span></span><br><span class=\"line\">    <span class=\"attr\">steps:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">uses:</span> <span class=\"string\">actions/checkout@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">token:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"comment\"># If your repository depends on submodule, please see: https://github.com/actions/checkout</span></span><br><span class=\"line\">          <span class=\"attr\">submodules:</span> <span class=\"string\">recursive</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Use</span> <span class=\"string\">Node.js</span> <span class=\"number\">16.</span><span class=\"string\">x</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/setup-node@v2</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">        <span class=\"comment\"># 看下自己本地的noe版本</span></span><br><span class=\"line\">          <span class=\"attr\">node-version:</span> <span class=\"string\">&#x27;16&#x27;</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Cache</span> <span class=\"string\">NPM</span> <span class=\"string\">dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">actions/cache@v2</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">path:</span> <span class=\"string\">node_modules</span></span><br><span class=\"line\">          <span class=\"attr\">key:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">runner.OS</span> <span class=\"string\">&#125;&#125;-npm-cache</span></span><br><span class=\"line\">          <span class=\"attr\">restore-keys:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache</span></span><br><span class=\"line\"><span class=\"string\"></span>      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Install</span> <span class=\"string\">Dependencies</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">install</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Build</span></span><br><span class=\"line\">        <span class=\"attr\">run:</span> <span class=\"string\">npm</span> <span class=\"string\">run</span> <span class=\"string\">build</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"attr\">name:</span> <span class=\"string\">Deploy</span></span><br><span class=\"line\">        <span class=\"attr\">uses:</span> <span class=\"string\">peaceiris/actions-gh-pages@v3</span></span><br><span class=\"line\">        <span class=\"attr\">with:</span></span><br><span class=\"line\">          <span class=\"attr\">github_token:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.GITHUB_TOKEN</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\">          <span class=\"attr\">publish_dir:</span> <span class=\"string\">./public</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"创建github-pages\"><a href=\"#创建github-pages\" class=\"headerlink\" title=\"创建github pages\"></a>创建github pages</h2><p>参考 <a href=\"https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site\">https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site</a></p>\n<p>创建完成后,微调一下:</p>\n<p>在<code>settings-&gt;Pages-&gt;Build and deployment-&gt;Branch</code>选项中,把<code>branch</code>改成<code>gh-pages</code></p>\n<h2 id=\"初始化本地仓库\"><a href=\"#初始化本地仓库\" class=\"headerlink\" title=\"初始化本地仓库\"></a>初始化本地仓库</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git init .</span><br><span class=\"line\">git remote add origin <span class=\"variable\">$&#123;你上面创建的仓库地址&#125;</span></span><br><span class=\"line\">git remote add  .</span><br><span class=\"line\">git commit  -m <span class=\"string\">&quot;init project&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"gitgnore\"><a href=\"#gitgnore\" class=\"headerlink\" title=\"gitgnore\"></a>gitgnore</h2><p>由于使用了<code>github</code>的自动部署功能,所以无需上传静态文件,在<code>hexo</code>根目录添加<code>.gitignore</code>文件</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public/</span><br><span class=\"line\">.deploy*/</span><br><span class=\"line\">node_modules</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"提交\"><a href=\"#提交\" class=\"headerlink\" title=\"提交\"></a>提交</h2><p>最后提交到<code>main</code>分支</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n<p>提交完成后,在<code>github</code>的<code>action</code>选项中可以看到正在构建,构建完成,就可以在<code>https://$&#123;your-username&#125;.github.io</code>路径访问你的在线博客了</p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://hexo.io/docs/github-pages\">https://hexo.io/docs/github-pages</a></p>\n","feature":true,"text":"hexo 提交后自动部署github page...","permalink":"/post/hexo-auto-deploy","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"hexo","slug":"hexo","count":1,"path":"api/categories/hexo.json"}],"tags":[{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#hexo-%E6%8F%90%E4%BA%A4%E5%90%8E%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2github-page\"><span class=\"toc-text\">hexo 提交后自动部署github page</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BAgithub-workflow\"><span class=\"toc-text\">创建github workflow</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BAgithub-pages\"><span class=\"toc-text\">创建github pages</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93\"><span class=\"toc-text\">初始化本地仓库</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#gitgnore\"><span class=\"toc-text\">gitgnore</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%8F%90%E4%BA%A4\"><span class=\"toc-text\">提交</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83\"><span class=\"toc-text\">参考</span></a></li></ol></li></ol>","author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"macos下,实现vim切换模式自动切换输入法","uid":"a80e863ad04e203843f50e139a5edeb2","slug":"macos-vim-auto-change-input-method","date":"2023-09-20T10:37:19.000Z","updated":"2023-11-07T19:50:51.339Z","comments":true,"path":"api/articles/macos-vim-auto-change-input-method.json","keywords":null,"cover":"https://source.unsplash.com/m_HRfLhgABo/1200x628","text":"macos结合使用,vim切换模式实现自动切换输入法...","permalink":"/post/macos-vim-auto-change-input-method","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"some litttle tricks","slug":"some-litttle-tricks","count":2,"path":"api/categories/some-litttle-tricks.json"}],"tags":[{"name":"vim","slug":"vim","count":3,"path":"api/tags/vim.json"},{"name":"macos","slug":"macos","count":1,"path":"api/tags/macos.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"neovim配置formatters","uid":"278663bc5f0ce8aa9f1bcfa6468a4791","slug":"neovim-config-formatter","date":"2023-11-01T16:05:14.000Z","updated":"2023-11-07T19:50:51.339Z","comments":true,"path":"api/articles/neovim-config-formatter.json","keywords":null,"cover":"https://source.unsplash.com/gray-laptop-computer-turned-on-EaB4Ml7C7fE/1200x628","text":"neovim配置formatters...","permalink":"/post/neovim-config-formatter","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"neovim奇技淫巧","slug":"neovim奇技淫巧","count":2,"path":"api/categories/neovim奇技淫巧.json"}],"tags":[{"name":"neovim","slug":"neovim","count":2,"path":"api/tags/neovim.json"}],"author":{"name":"finger","slug":"blog-author","avatar":"/assets/images/logo.jpg","link":"/","description":"do something funny","socials":{"github":"https://github.com/fingergohappy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}